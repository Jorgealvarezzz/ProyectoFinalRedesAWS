<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reportes y Estad√≠sticas - StatsBasket</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Librer√≠as optimizadas para PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body>
    <!-- Header principal -->
    <div class="hero">
        <div class="hero-content">
            <h1>üìä REPORTES Y ESTAD√çSTICAS</h1>
            <p class="subtitle">An√°lisis completo del rendimiento del equipo</p>
            <div id="backup-host"></div>
        </div>
    </div>

    <!-- Contenedor principal del reporte -->
    <div class="container" id="report-root">
        
        <!-- Gesti√≥n de partidos -->
        <div class="card">
            <h2>üèÄ Gesti√≥n de Partidos</h2>
            
            <div class="game-management-controls">
                <button class="btn danger" onclick="clearAllGames()">
                    üóëÔ∏è Eliminar TODOS los partidos
                </button>
                <button class="btn secondary" onclick="deleteCompletedGames()">
                    üßπ Limpiar completados
                </button>
                <button class="btn ghost" onclick="toggleGameManagement()">
                    ‚öôÔ∏è Modo gesti√≥n
                </button>
            </div>
            
            <div id="game-selector">
                <!-- Se carga din√°micamente -->
            </div>
        </div>

        <!-- Informaci√≥n del partido seleccionado -->
        <div class="card" id="game-info-card" style="display: none;">
            <div class="game-header">
                <h2 id="game-title"></h2>
                <div class="game-meta" id="game-details"></div>
            </div>
            
            <!-- Acciones de exportaci√≥n -->
            <div class="export-actions">
                <button class="btn primary" onclick="exportPDF()">
                    üìÑ Descargar PDF Completo
                </button>
                <button class="btn secondary" onclick="exportExcel()">
                    üìã Exportar Excel
                </button>
                <button class="btn ghost" onclick="printReport()">
                    üñ®Ô∏è Imprimir Reporte
                </button>
            </div>
        </div>

        <!-- Insights autom√°ticos para el coach -->
        <div class="card" id="coaching-insights" style="display: none;">
            <h2>üí° Insights Autom√°ticos para el Coach</h2>
            <div id="insights-container">
                <!-- Se genera din√°micamente -->
            </div>
        </div>

        <!-- An√°lisis completo de tiros por zona -->
        <div class="card" id="shot-analysis" style="display: none;">
            <h2>üéØ An√°lisis Completo de Tiros por Zona</h2>
            
            <!-- Resumen ejecutivo -->
            <div class="shooting-summary">
                <h3>üìà Resumen Ejecutivo de Tiros</h3>
                <div class="summary-grid">
                    <div class="summary-card">
                        <h4>Tiros de 2 Puntos</h4>
                        <div class="big-stat" id="two-point-percentage">0%</div>
                        <div class="stat-detail" id="two-point-detail">0/0</div>
                    </div>
                    <div class="summary-card">
                        <h4>Tiros de 3 Puntos</h4>
                        <div class="big-stat" id="three-point-percentage">0%</div>
                        <div class="stat-detail" id="three-point-detail">0/0</div>
                    </div>
                    <div class="summary-card best-zone">
                        <h4>üî• Zona M√°s Efectiva</h4>
                        <div class="best-zone-name" id="best-zone-name">-</div>
                        <div class="best-zone-stat" id="best-zone-stat">0%</div>
                    </div>
                    <div class="summary-card worst-zone">
                        <h4>‚ùÑÔ∏è Zona a Mejorar</h4>
                        <div class="worst-zone-name" id="worst-zone-name">-</div>
                        <div class="worst-zone-stat" id="worst-zone-stat">0%</div>
                    </div>
                </div>
            </div>

            <!-- Desglose detallado por zona -->
            <div class="zones-analysis">
                <h3>üìä Efectividad Detallada por Zona</h3>
                <div class="zones-grid" id="zones-breakdown">
                    <!-- Se carga din√°micamente -->
                </div>
            </div>

            <!-- Mapa de calor visual -->
            <div class="heat-map-section">
                <h3>üó∫Ô∏è Mapa de Calor de Efectividad</h3>
                <div class="court-heatmap" id="court-heatmap">
                    <!-- Se carga din√°micamente -->
                </div>
            </div>
        </div>

        <!-- Box Score Completo (NUEVO) -->
        <div class="card stats-table-card" id="full-box-score" style="display: none;">
            <h2>üìã BOX SCORE COMPLETO DEL EQUIPO</h2>
            <div class="table-container">
                <table class="stats-table" id="full-box-table">
                    <thead>
                        <tr>
                            <th class="player-col">JUGADOR</th>
                            <th>ROL</th>
                            <th>MIN</th>
                            <th>2P</th>
                            <th>%2P</th>
                            <th>3P</th>
                            <th>%3P</th>
                            <th>FT</th>
                            <th>%FT</th>
                            <th>OREB</th>
                            <th>DREB</th>
                            <th>REB</th>
                            <th>AST</th>
                            <th>STL</th>
                            <th>BLK</th>
                            <th>TOV</th>
                            <th>PF</th>
                            <th>+/-</th>
                            <th>PTS</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Box Score - Titulares -->
        <div class="card stats-table-card" id="starters-stats" style="display: none;">
            <h2>üèÜ JUGADORES TITULARES</h2>
            <div class="table-container">
                <table class="stats-table" id="starters-table">
                    <thead>
                        <tr>
                            <th class="player-col">JUGADOR</th>
                            <th>MIN</th>
                            <th>FG</th>
                            <th>%2PT</th>
                            <th>3P</th>
                            <th>%3PT</th>
                            <th>FT</th>
                            <th>%FT</th>
                            <th>OREB</th>
                            <th>DREB</th>
                            <th>REB</th>
                            <th>AST</th>
                            <th>STL</th>
                            <th>BLK</th>
                            <th>TOV</th>
                            <th>PF</th>
                            <th>+/-</th>
                            <th>PTS</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Box Score - Suplentes -->
        <div class="card stats-table-card" id="bench-stats" style="display: none;">
            <h2>üîÑ JUGADORES SUPLENTES</h2>
            <div class="table-container">
                <table class="stats-table" id="bench-table">
                    <thead>
                        <tr>
                            <th class="player-col">JUGADOR</th>
                            <th>MIN</th>
                            <th>FG</th>
                            <th>%2PT</th>
                            <th>3P</th>
                            <th>%3PT</th>
                            <th>FT</th>
                            <th>%FT</th>
                            <th>OREB</th>
                            <th>DREB</th>
                            <th>REB</th>
                            <th>AST</th>
                            <th>STL</th>
                            <th>BLK</th>
                            <th>TOV</th>
                            <th>PF</th>
                            <th>+/-</th>
                            <th>PTS</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Totales del equipo -->
        <div class="card stats-table-card" id="team-totals" style="display: none;">
            <h2>üìä ESTAD√çSTICAS TOTALES DEL EQUIPO</h2>
            <div class="table-container">
                <table class="stats-table" id="team-table">
                    <thead>
                        <tr>
                            <th class="player-col">TOTALES</th>
                            <th>MIN</th>
                            <th>FG</th>
                            <th>%2PT</th>
                            <th>3P</th>
                            <th>%3PT</th>
                            <th>FT</th>
                            <th>%FT</th>
                            <th>OREB</th>
                            <th>DREB</th>
                            <th>REB</th>
                            <th>AST</th>
                            <th>STL</th>
                            <th>BLK</th>
                            <th>TOV</th>
                            <th>PF</th>
                            <th>+/-</th>
                            <th>PTS</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- An√°lisis por cuartos -->
        <div class="card" id="quarter-stats" style="display: none;">
            <h2>üìà Rendimiento por Cuarto</h2>
            <div class="quarters-grid">
                <div class="quarter-card">
                    <h3>1er Cuarto</h3>
                    <div id="q1-stats" class="quarter-stats-content"></div>
                </div>
                <div class="quarter-card">
                    <h3>2do Cuarto</h3>
                    <div id="q2-stats" class="quarter-stats-content"></div>
                </div>
                <div class="quarter-card">
                    <h3>3er Cuarto</h3>
                    <div id="q3-stats" class="quarter-stats-content"></div>
                </div>
                <div class="quarter-card">
                    <h3>4to Cuarto</h3>
                    <div id="q4-stats" class="quarter-stats-content"></div>
                </div>
            </div>
        </div>

        <!-- Timeline completo del partido -->
        <div class="card" id="game-timeline" style="display: none;">
            <h2>‚è±Ô∏è Timeline Completo del Partido</h2>
            <div class="timeline-container" id="timeline-content">
                <!-- Se carga din√°micamente -->
            </div>
        </div>

        <!-- Navegaci√≥n principal -->
        <div class="card" style="text-align: center; margin-top: 2rem;">
            <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                <a href="index.html" class="btn ghost">üè† Ir al Inicio</a>
                <a href="live.html" class="btn secondary" id="back-to-live" style="display: none;">
                    ‚Üê Volver al Partido en Vivo
                </a>
                <a href="partido.html" class="btn primary">üÜï Crear Nuevo Partido</a>
            </div>
        </div>
    </div>

    <script type="module" src="reportes.js"></script>
</body>
</html>